# -*- coding: utf-8 -*-
import os
import tempfile
import unittest
from unittest import TestCase

from factory.backends.config import ConfigBackend


class ConfigBackendTestCase(TestCase):
    def test(self):
        with tempfile.TemporaryDirectory() as temp:
            path = os.path.join(temp, 'factory.cfg')
            with open(path, 'w', encoding='utf-8') as fd:
                fd.write('''
[SUBVERSION]
user = cis
passwd = Ntic2007
url = http://avalon.bams.corp:3180/svn/repos/gp/trunk

[ARTIFACT]
user = cis
passwd = zE0mk2A4crGS9MrTIR00
source_url = http://nx-artifacts:8085/artifactory/gp3-adl-sources-test
binary_url = http://nx-artifacts:8085/artifactory/gp3-adl-binaries-test
compiler_url = http://nx-artifacts:8085/artifactory/gp3-binaries

[I18N]
legacy_mo_url = http://chardon:16180/gp3/mlg

[REPOSITORY]
host = neptune
user = gp2006pi
passwd = ntic2004
cwd = /home/gp2006pi/delia_test_repo

[COMPILER]
timeout = 900

[FRAME]
java_home = /workspace/bin/java/current
''')
            backend = ConfigBackend(path)
            self.assertEqual('cis', backend.svn_user)
            self.assertEqual('Ntic2007', backend.svn_passwd)
            self.assertEqual('http://avalon.bams.corp:3180/svn/repos/gp/trunk', backend.svn_url)
            self.assertEqual(900, backend.compiler_timeout)


if __name__ == '__main__':
    unittest.main()
